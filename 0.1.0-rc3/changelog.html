

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Changelog &mdash; zrepl  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/banner.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Talks &amp; Presentations" href="pr.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> zrepl
          

          
            
            <img src="_static/zrepl.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">Implementation Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="pr.html">Talks &amp; Presentations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">0.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#notes-to-package-maintainers">Notes to Package Maintainers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changes">Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#previous-releases">Previous Releases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/zrepl/zrepl">GitHub Repository &amp; Issue Tracker</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">zrepl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Changelog</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/zrepl/zrepl/blob/0.1.0-rc3/docs/changelog.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><a href="../master/changelog.html"><b>Warning:</b> This document is for an old version of zrepl. The main version is master.</a></p>
<div class="section" id="changelog">
<span id="id1"></span><h1>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h1>
<p>The changelog summarizes bugfixes that are deemed relevant for users and package maintainers.
Developers should consult the git commit log or GitHub issue tracker.</p>
<p>We use the following annotations for classifying changes:</p>
<ul class="simple">
<li><strong>[CONFIG]</strong> Change that breaks the config.
As a package maintainer, make sure to warn your users about config breakage somehow.</li>
<li><strong>[BREAK]</strong> Change that breaks interoperability or persistent state representation with previous releases.
As a package maintainer, make sure to warn your users about config breakage somehow.
Note that even updating the package on both sides might not be sufficient, e.g. if persistent state needs to be migrated to a new format.</li>
<li>[FEATURE] Change that introduces new functionality.</li>
<li>[BUG] Change that fixes a bug, no regressions or incompatibilities expected.</li>
<li>[DOCS] Change to the documentation.</li>
</ul>
<div class="section" id="id2">
<h2>0.1<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>This release is a milestone for zrepl and required significant refactoring if not rewrites of substantial parts of the application.
It breaks both configuration and transport format, and thus requires manual intervention and updates on both sides of a replication setup.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">The changes in the pruning system for this release require you to explicitly define <strong>keep rules</strong>:
for any snapshot that you want to keep, at least one rule must match.
This is different from previous releases where pruning only affected snapshots with the configured snapshotting prefix.
Make sure that snapshots to be kept or ignored by zrepl are covered, e.g. by using the <code class="docutils literal notranslate"><span class="pre">regex</span></code> keep rule.
<a class="reference internal" href="configuration/prune.html#prune"><span class="std std-ref">Learn more in the config docs…</span></a></p>
</div>
<div class="section" id="notes-to-package-maintainers">
<h3>Notes to Package Maintainers<a class="headerlink" href="#notes-to-package-maintainers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If the daemon crashes, the stack trace produced by the Go runtime and possibly diagnostic output of zrepl will be written to stderr.
This behavior is independent from the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> outlet type.
Please make sure the stderr output of the daemon is captured somewhere.
To conserve precious stack traces, make sure that multiple service restarts do not directly discard previous stderr output.</li>
<li>Make it obvious for users how to set the <code class="docutils literal notranslate"><span class="pre">GOTRACEBACK</span></code> environment variable to <code class="docutils literal notranslate"><span class="pre">GOTRACEBACK=crash</span></code>.
This functionality will cause SIGABRT on panics and can be used to capture a coredump of the panicking process.
To that extend, make sure that your package build system, your OS’s coredump collection and the Go delve debugger work together.
Use your build system to package the Go program in <a class="reference external" href="https://rakyll.org/coredumps/">this tutorial on Go coredumps and the delve debugger</a> , and make sure the symbol resolution etc. work on coredumps captured from the binary produced by your build system. (Special focus on symbol stripping, etc.)</li>
<li>Use of <code class="docutils literal notranslate"><span class="pre">ssh+stdinserver</span></code> <a class="reference internal" href="configuration/transports.html#transport-ssh-stdinserver"><span class="std std-ref">transport</span></a> is no longer encouraged.
Please encourage users to use the new <code class="docutils literal notranslate"><span class="pre">tcp</span></code> or <code class="docutils literal notranslate"><span class="pre">tls</span></code> transports.
You might as well mention some of the <a class="reference internal" href="configuration/transports.html#transport-tcp-tunneling"><span class="std std-ref">tunneling options listed here</span></a>.</li>
</ul>
</div>
<div class="section" id="changes">
<h3>Changes<a class="headerlink" href="#changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>[FEATURE] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/55">issue #55</a> : Push replication (see <a class="reference internal" href="configuration/jobs.html#job-push"><span class="std std-ref">push job</span></a> and <a class="reference internal" href="configuration/jobs.html#job-sink"><span class="std std-ref">sink job</span></a>)</li>
<li>[FEATURE] <a class="reference internal" href="configuration/transports.html#transport-tcp"><span class="std std-ref">TCP Transport</span></a></li>
<li>[FEATURE] <a class="reference internal" href="configuration/transports.html#transport-tcp-tlsclientauth"><span class="std std-ref">TCP + TLS client authentication transport</span></a></li>
<li>[FEATURE] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/78">issue #78</a> <a class="reference external" href="https://github.com/zrepl/zrepl/commit/074f989">commit 074f989</a> : Replication protocol rewrite<ul>
<li>Uses <code class="docutils literal notranslate"><span class="pre">github.com/problame/go-streamrpc</span></code> for RPC layer</li>
<li><strong>[BREAK]</strong> Protocol breakage, update and restart of all zrepl daemons is required</li>
<li>[FEATURE] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/83">issue #83</a>:  Improved error handling of network-level errors (zrepl retries instead of failing the entire job)</li>
<li>[BUG] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/75">issue #75</a> <a class="reference external" href="https://github.com/zrepl/zrepl/issues/81">issue #81</a>: use connection timeouts and protocol-level heartbeats</li>
<li><strong>[BREAK]</strong> <strong>[CONFIG]</strong>: mappings are no longer supported<ul>
<li>Receiving sides (<code class="docutils literal notranslate"><span class="pre">pull</span></code> and <code class="docutils literal notranslate"><span class="pre">sink</span></code> job) specify a single <code class="docutils literal notranslate"><span class="pre">root_fs</span></code>.
Received filesystems are then stored <em>per client</em> in <code class="docutils literal notranslate"><span class="pre">${root_fs}/${client_identity}</span></code>.</li>
</ul>
</li>
</ul>
</li>
<li>[FEATURE] <strong>[BREAK]</strong> <strong>[CONFIG]</strong> Manual snapshotting + triggering of replication<ul>
<li>[FEATURE] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/69">issue #69</a>: include manually created snapshots in replication</li>
<li><strong>[CONFIG]</strong> <code class="docutils literal notranslate"><span class="pre">manual</span></code> and <code class="docutils literal notranslate"><span class="pre">periodic</span></code> <a class="reference internal" href="configuration/jobs.html#job-snapshotting-spec"><span class="std std-ref">snapshotting types</span></a></li>
<li>[FEATURE] <code class="docutils literal notranslate"><span class="pre">zrepl</span> <span class="pre">signal</span> <span class="pre">wakeup</span> <span class="pre">JOB</span></code> subcommand to trigger replication + pruning</li>
<li>[FEATURE] <code class="docutils literal notranslate"><span class="pre">zrepl</span> <span class="pre">signal</span> <span class="pre">reset</span> <span class="pre">JOB</span></code> subcommand to abort current replication + pruning</li>
</ul>
</li>
<li>[FEATURE] <strong>[BREAK]</strong> <strong>[CONFIG]</strong> New pruning system<ul>
<li>The active side of a replication (pull or push) decides what to prune for both sender and receiver.
The RPC protocol is used to execute the destroy operations on the remote side.</li>
<li>New pruning policies (see <a class="reference internal" href="configuration/prune.html#prune"><span class="std std-ref">configuration documentation</span></a> )<ul>
<li>The decision what snapshots shall be pruned is now made based on <em>keep rules</em></li>
<li>[FEATURE] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/68">issue #68</a>: keep rule <code class="docutils literal notranslate"><span class="pre">not_replicated</span></code> prevents divergence of sender and receiver</li>
</ul>
</li>
<li>[FEATURE] <strong>[BREAK]</strong> Bookmark pruning is no longer necessary<ul>
<li>Per filesystem, zrepl creates a single bookmark (<code class="docutils literal notranslate"><span class="pre">#zrepl_replication_cursor</span></code>) and moves it forward with the most recent successfully replicated snapshot on the receiving side.</li>
<li>Old bookmarks created by prior versions of zrepl (named like their corresponding snapshot) must be deleted manually.</li>
<li><strong>[CONFIG]</strong> <code class="docutils literal notranslate"><span class="pre">keep_bookmarks</span></code> parameter of the <code class="docutils literal notranslate"><span class="pre">grid</span></code> keep rule has been removed</li>
</ul>
</li>
</ul>
</li>
<li>[FEATURE] <code class="docutils literal notranslate"><span class="pre">zrepl</span> <span class="pre">status</span></code> for live-updating replication progress (it’s really cool!)</li>
<li>[FEATURE] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/67">issue #67</a>: Expose <a class="reference external" href="https://prometheus.io">Prometheus</a> metrics via HTTP (<a class="reference internal" href="configuration/monitoring.html#monitoring-prometheus"><span class="std std-ref">config docs</span></a>)</li>
<li><strong>[CONFIG]</strong> Logging outlet types must be specified using the <code class="docutils literal notranslate"><span class="pre">type</span></code> instead of <code class="docutils literal notranslate"><span class="pre">outlet</span></code> key</li>
<li><strong>[BREAK]</strong> <a class="reference external" href="https://github.com/zrepl/zrepl/issues/53">issue #53</a>: CLI: <code class="docutils literal notranslate"><span class="pre">zrepl</span> <span class="pre">control</span> <span class="pre">*</span></code> subcommands have been made direct subcommands of <code class="docutils literal notranslate"><span class="pre">zrepl</span> <span class="pre">*</span></code></li>
<li>[BUG] Goroutine leak on ssh transport connection timeouts</li>
<li>[BUG] <a class="reference external" href="https://github.com/zrepl/zrepl/issues/81">issue #81</a> <a class="reference external" href="https://github.com/zrepl/zrepl/issues/77">issue #77</a> : handle failed accepts correctly (<code class="docutils literal notranslate"><span class="pre">source</span></code> job)</li>
</ul>
</div>
</div>
<div class="section" id="previous-releases">
<h2>Previous Releases<a class="headerlink" href="#previous-releases" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to limitations in our documentation system, we only show the changelog since the last release and the time this documentation is built.
For the changelog of previous releases, use the version selection in the hosted version of these docs at <a class="reference external" href="https://zrepl.github.io">zrepl.github.io</a>.</p>
</div>
<p>W</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="pr.html" class="btn btn-neutral float-left" title="Talks &amp; Presentations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, Christian Schwarz

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: 0.1.0-rc3
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../0.0.2/changelog.html">0.0.2</a></dd>
            <dd><a href="../0.0.3/changelog.html">0.0.3</a></dd>
            <dd><a href="changelog.html">0.1.0-rc3</a></dd>
            <dd><a href="../0.1.0-rc4/changelog.html">0.1.0-rc4</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../master/changelog.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>